diff -ruN e3/drivers/crypto/inside-secure/eip93/eip93-cipher.c e4/drivers/crypto/inside-secure/eip93/eip93-cipher.c
--- e3/drivers/crypto/inside-secure/eip93/eip93-cipher.c	2026-02-17 01:59:53.201371000 +0100
+++ e4/drivers/crypto/inside-secure/eip93/eip93-cipher.c	2026-02-17 07:57:05.321313100 +0100
@@ -135,12 +135,8 @@
 {
 	struct crypto_tfm *tfm = crypto_skcipher_tfm(ctfm);
 	struct eip93_crypto_ctx *ctx = crypto_tfm_ctx(tfm);
-	struct eip93_alg_template *tmpl = container_of(tfm->__crt_alg,
-						     struct eip93_alg_template,
-						     alg.skcipher.base);
 	struct sa_record *sa_record = ctx->sa_record_out;
 	unsigned int keylen = len;
-	u32 flags = tmpl->flags;
 	u32 nonce = 0;
 	static const size_t sa_size = sizeof(struct sa_record);
 	int ret;
@@ -148,7 +144,7 @@
 	if (!key || !keylen)
 		return -EINVAL;
 
-	if (IS_RFC3686(flags)) {
+	if (IS_RFC3686(ctx->flags)) {
 		if (len < CTR_RFC3686_NONCE_SIZE)
 			return -EINVAL;
 
@@ -156,24 +152,24 @@
 		memcpy(&nonce, key + keylen, CTR_RFC3686_NONCE_SIZE);
 	}
 
-	if (flags & EIP93_ALG_DES) {
+	if (ctx->flags & EIP93_ALG_DES) {
 		ctx->blksize = DES_BLOCK_SIZE;
 		ret = verify_skcipher_des_key(ctfm, key);
 		if (ret)
 			return ret;
 	}
-	if (flags & EIP93_ALG_3DES) {
+	if (ctx->flags & EIP93_ALG_3DES) {
 		ctx->blksize = DES3_EDE_BLOCK_SIZE;
 		ret = verify_skcipher_des3_key(ctfm, key);
 		if (ret)
 			return ret;
 	}
 
-	if (flags & EIP93_ALG_AES) {
+	if (ctx->flags & EIP93_ALG_AES) {
 		struct crypto_aes_ctx aes;
-		bool fallback = eip93_skcipher_is_fallback(tfm, flags);
+		bool fallback = eip93_skcipher_is_fallback(tfm, ctx->flags);
 
-		if (fallback && !IS_RFC3686(flags)) {
+		if (fallback && !IS_RFC3686(ctx->flags)) {
 			ret = crypto_skcipher_setkey(ctx->fallback, key,
 						     keylen);
 			if (ret)
@@ -191,7 +187,7 @@
 	dma_sync_single_for_cpu(ctx->eip93->dev, ctx->sa_record_base_in,
 				sa_size, DMA_TO_DEVICE);
 
-	eip93_set_sa_record(sa_record, keylen, flags);
+	eip93_set_sa_record(sa_record, keylen, ctx->flags);
 
 	memcpy(sa_record->sa_key, key, keylen);
 	ctx->sa_nonce = nonce;
